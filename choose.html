<script>
const p = new URLSearchParams(location.search);
const type = p.get("type");

let finalURL = "";

function generate(){
  const you = document.getElementById("you").value.trim();
  const partner = document.getElementById("partner").value.trim();
  const msg = document.getElementById("message").value.trim();

  if(!you || !partner || !msg){
    alert("Please fill all fields ðŸ’•");
    return;
  }

  // Build full absolute URL
  finalURL = `${window.location.origin}/will-you-marry-me/proposal.html?type=${type}&you=${encodeURIComponent(you)}&partner=${encodeURIComponent(partner)}&msg=${encodeURIComponent(msg)}`;

  document.getElementById("urlBox").innerText = finalURL;

  document.getElementById("afterGenerate").classList.remove("hidden");
}

function copyLink(){
  navigator.clipboard.writeText(finalURL)
    .then(() => alert("Link copied ðŸ”—"))
    .catch(() => alert("Copy failed"));
}

function openLink(){
  if(finalURL){
    window.open(finalURL, "_blank");
  }
}
</script>
